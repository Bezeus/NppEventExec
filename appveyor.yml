version: 0.1.1.{build}
image: Visual Studio 2015


environment:
  matrix:
    #- PlatformToolset: v140_xp
    - PlatformToolset: v120_xp
    #- PlatformToolset: mingw-w64


platform:
    - x64
    - Win32

configuration:
    - Release
    - Debug

install:
    - if "%platform%"=="x64" set archi=amd64
    - if "%platform%"=="Win32" set archi=x86
    - call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" %archi%

    - ps: |
        if ($env:PLATFORMTOOLSET -match "mingw-w64") {
          $env:Path += ";C:\mingw-w64\i686-5.3.0-posix-dwarf-rt_v4-rev0\mingw32\bin"
          $env:Path += ";C:\mingw-w64\i686-5.3.0-posix-dwarf-rt_v4-rev0\mingw32\i686-w64-mingw32\lib"
          $env:Path = $env:Path.Replace('C:\Program Files\Git\usr\bin;','')
          g++ --version
          mingw32-make --version
        }
        
before_build:
  - nuget restore -PackagesDirectory .\packages
        
build:
    verbosity: minimal

build_script:
    - cd "%APPVEYOR_BUILD_FOLDER%"
    - msbuild NppEventExec.vcxproj /p:configuration="%configuration%" /p:platform="%platform%" /p:PlatformToolset="%PlatformToolset%"

